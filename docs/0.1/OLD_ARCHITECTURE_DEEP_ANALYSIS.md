# ğŸ“š æ—§ç‰ˆæ–‡çŒ®ç®¡ç†ç³»ç»Ÿæ·±åº¦æ¶æ„åˆ†æ

> **æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
> **åˆ†ææ—¥æœŸ**: 2025-01-30  
> **çŠ¶æ€**: âœ… æ·±åº¦åˆ†æå®Œæˆ

---

## ğŸ¯ æ¦‚è¿°

ç»è¿‡æ·±å…¥åˆ†æ `old/src` ç›®å½•ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ª**åŠŸèƒ½æå…¶ä¸°å¯Œä¸”æ¶æ„å¤æ‚**çš„æ–‡çŒ®ç®¡ç†ç³»ç»Ÿã€‚å…¶å¤æ‚æ€§å’Œå®Œæ•´æ€§è¿œè¶…é¢„æœŸï¼ŒåŒ…å«äº†å®Œæ•´çš„AIé›†æˆã€å®æ—¶æ›´æ–°ã€æ™ºèƒ½å»é‡ã€å¼•æ–‡ç®¡ç†ç­‰é«˜çº§åŠŸèƒ½ã€‚

---

## ğŸ—ï¸ æ¶æ„å…¨æ™¯å›¾

### **ç›®å½•ç»“æ„åˆ†æ**
```
old/src/
â”œâ”€â”€ libs/              # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ (76+ files)
â”‚   â”œâ”€â”€ db/           # æ•°æ®åº“å±‚ (10 files, 3000+ lines)
â”‚   â”œâ”€â”€ mcts/         # MCTSç®—æ³•å±‚ (13 files)
â”‚   â”œâ”€â”€ research/     # ç ”ç©¶æœåŠ¡å±‚ (5 files)
â”‚   â”œâ”€â”€ backend/      # åç«¯é›†æˆå±‚ (4 files)
â”‚   â”œâ”€â”€ fetching/     # æ–‡çŒ®è·å–å±‚ (9 files)
â”‚   â””â”€â”€ zotero/       # Zoteroé›†æˆå±‚ (3 files)
â”œâ”€â”€ store/            # çŠ¶æ€ç®¡ç†å±‚ (6+ files)
â”œâ”€â”€ components/       # UIç»„ä»¶å±‚ (100+ files)
â”œâ”€â”€ hooks/            # ä¸šåŠ¡é€»è¾‘Hooks (15+ files)
â”œâ”€â”€ domains/          # é¢†åŸŸæ¨¡å‹å±‚ (4 domains)
â”œâ”€â”€ types/            # ç±»å‹å®šä¹‰å±‚
â””â”€â”€ infrastructure/   # åŸºç¡€è®¾æ–½å±‚
```

### **å¤æ‚åº¦é‡åŒ–**
- **æ€»ä»£ç é‡**: ä¼°è®¡10,000+ è¡Œ
- **æ ¸å¿ƒçŠ¶æ€ç®¡ç†**: libraryStore.ts (1,245è¡Œ)
- **æ•°æ®æœåŠ¡å±‚**: LibraryService.ts (1,018è¡Œ)
- **UIç»„ä»¶**: 20+ ä¸“é—¨çš„æ–‡çŒ®ç®¡ç†ç»„ä»¶
- **ä¸šåŠ¡é€»è¾‘**: 15+ ä¸“é—¨çš„Hooks

---

## ğŸ” æ ¸å¿ƒç»„ä»¶æ·±åº¦åˆ†æ

### 1. **çŠ¶æ€ç®¡ç†å±‚ (libraryStore.ts - 1,245è¡Œ)**

#### âœ¨ **æ ¸å¿ƒç‰¹æ€§**
```typescript
interface SimplifiedLibraryState {
  // ğŸ“š æ ¸å¿ƒæ•°æ®
  items: LibraryItem[];                    // æ–‡çŒ®åˆ—è¡¨
  trees: LiteratureTree[];                 // ç ”ç©¶æ ‘
  activeTreeController: TreeController;    // æ´»è·ƒæ ‘æ§åˆ¶å™¨
  
  // ğŸ” æœç´¢è¿‡æ»¤
  sourceFilter: LiteratureSourceEnum;     // æ¥æºç­›é€‰
  searchTerm: string;                      // æœç´¢è¯
  topicFilter: string[];                   // ä¸»é¢˜ç­›é€‰
  
  // ğŸ“¡ SSEå®æ—¶çŠ¶æ€
  activeSubmissions: Map<string, LiteratureSubmissionState>; // å®æ—¶æäº¤çŠ¶æ€
}
```

#### ğŸš€ **é«˜çº§åŠŸèƒ½**
1. **SSEå®æ—¶æ›´æ–°** - Server-Sent Eventså®æ—¶çŠ¶æ€æ¨é€
2. **æ™ºèƒ½å»é‡åˆå¹¶** - åŸºäºURL/DOI/æ ‡é¢˜çš„æ™ºèƒ½åŒ¹é…
3. **å¹¶å‘æ§åˆ¶** - æ‰¹é‡æ“ä½œçš„å¹¶å‘é™åˆ¶(5ä¸ªå¹¶å‘)
4. **ä¼šè¯å…³è”** - æ–‡çŒ®ä¸ç ”ç©¶ä¼šè¯çš„åŠ¨æ€å…³è”
5. **å¼•æ–‡è‡ªåŠ¨é“¾æ¥** - æ–°æ–‡çŒ®è‡ªåŠ¨å»ºç«‹å¼•ç”¨å…³ç³»
6. **é”™è¯¯æ¢å¤** - å®Œå–„çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æ¢å¤

#### ğŸ“Š **æ•°æ®æµè®¾è®¡**
```typescript
// SSEæäº¤æµç¨‹
submitLiterature() â†’ 
  ç«‹å³åˆ›å»ºå ä½æ–‡çŒ® â†’ 
  SSEå®æ—¶çŠ¶æ€æ›´æ–° â†’ 
  å®Œæˆåæ™ºèƒ½åˆå¹¶ â†’ 
  è‡ªåŠ¨å¼•æ–‡é“¾æ¥ â†’ 
  çŠ¶æ€æ¸…ç†
```

### 2. **æ•°æ®å±‚ (libs/db/ - 10æ–‡ä»¶)**

#### ğŸ—„ï¸ **æ•°æ®åº“è®¾è®¡**
```typescript
// æ ¸å¿ƒå®ä½“
LibraryItem {
  id: string;                        // UUIDä¸»é”®
  title: string;                     // æ ‡é¢˜
  authors: string[];                 // ä½œè€…æ•°ç»„
  year: number;                      // å¹´ä»½
  source: LiteratureSource;          // æ¥æºæšä¸¾
  
  // å…ƒæ•°æ®
  publication?: string;              // æœŸåˆŠ
  abstract?: string;                 // æ‘˜è¦
  doi?: string;                      // DOI
  url?: string;                      // URL
  
  // è§£æå†…å®¹
  parsedContent?: {
    extractedText?: string;          // æå–æ–‡æœ¬
    extractedReferences?: any[];     // è§£æå¼•ç”¨
  };
  
  // åç«¯é›†æˆ
  backendTask?: BackendTask;         // åç«¯ä»»åŠ¡çŠ¶æ€
  
  // å…³è”æ•°æ®
  topics?: string[];                 // ä¸»é¢˜æ ‡ç­¾
  associatedSessions?: string[];     // å…³è”ä¼šè¯
}
```

#### ğŸ”§ **æ™ºèƒ½åŒ¹é…ç³»ç»Ÿ**
```
matching/
â”œâ”€â”€ MatchingEngine.ts      # æ™ºèƒ½æŸ¥é‡å¼•æ“
â”œâ”€â”€ CitationLinker.ts      # å¼•æ–‡é“¾æ¥å™¨
â”œâ”€â”€ ReferenceExtractor.ts  # å¼•ç”¨æå–å™¨
â””â”€â”€ SimilarityCalculator.ts # ç›¸ä¼¼åº¦è®¡ç®—å™¨
```

**åŒ¹é…ç­–ç•¥**:
1. **URLç²¾ç¡®åŒ¹é…** - DOI/URLä¼˜å…ˆçº§åŒ¹é…
2. **æ ‡é¢˜æ¨¡ç³ŠåŒ¹é…** - åŸºäºç¼–è¾‘è·ç¦»
3. **ä½œè€…åŒ¹é…** - ä½œè€…åˆ—è¡¨äº¤é›†
4. **å¹´ä»½å®¹é”™** - Â±1å¹´å®¹å·®

#### ğŸ“„ **ç‰ˆæœ¬ç®¡ç†**
- **7ä¸ªæ•°æ®åº“ç‰ˆæœ¬** - å®Œå–„çš„è¿ç§»æœºåˆ¶
- **å‘åå…¼å®¹** - ä¿ç•™æ—§æ•°æ®å®Œæ•´æ€§
- **å¢é‡ç´¢å¼•** - æ€§èƒ½ä¼˜åŒ–çš„ç´¢å¼•ç­–ç•¥

### 3. **UIç»„ä»¶å±‚ (components/Library/ - 20+ç»„ä»¶)**

#### ğŸ¨ **æ ¸å¿ƒç»„ä»¶**
```typescript
// ä¸»è¦ç»„ä»¶ç»“æ„
LiteratureList {
  - åˆ†é¡µ: Pagination
  - æ’åº: å¤šå­—æ®µæ’åº (title/year/createdAt/authors)
  - ç­›é€‰: æ¥æº/æœç´¢è¯/ä¸»é¢˜
  - æ‰¹é‡æ“ä½œ: å¤šé€‰åˆ é™¤
  - è§†å›¾æ¨¡å¼: List/Gridåˆ‡æ¢
}

AddLiteratureForm {
  - è¡¨å•éªŒè¯: Zod Schema
  - åŠ¨æ€å­—æ®µ: Authorsæ•°ç»„
  - ä¸»é¢˜ç®¡ç†: Topicsæ ‡ç­¾
  - æ¥æºé€‰æ‹©: å¤šç§æ–‡çŒ®æ¥æº
}

LiteratureListItem {
  - çŠ¶æ€æ˜¾ç¤º: è§£æ/å¤„ç†çŠ¶æ€
  - æ“ä½œèœå•: ç¼–è¾‘/åˆ é™¤/é€‰æ‹©
  - å¼•æ–‡é¢„è§ˆ: å…³è”æ–‡çŒ®
}
```

#### ğŸ”§ **é«˜çº§åŠŸèƒ½ç»„ä»¶**
- **CitationGraph** - å¼•æ–‡å…³ç³»å¯è§†åŒ–
- **TreeVisualization** - ç ”ç©¶æ ‘å¯è§†åŒ–
- **ZoteroImport** - ZoteroåŒæ­¥é›†æˆ
- **BulkImportDialog** - æ‰¹é‡å¯¼å…¥å¯¹è¯æ¡†

### 4. **ä¸šåŠ¡é€»è¾‘å±‚ (hooks/ - 15+hooks)**

#### ğŸ¯ **æ ¸å¿ƒHooks**
```typescript
useLiteratureResearch {
  // ğŸŒ± æ–‡çŒ®æ’­ç§
  runLiteratureSeeding(topic, reportPlan) â†’ 
    ç”Ÿæˆæœç´¢ä»»åŠ¡ â†’ 
    AIé©±åŠ¨æœç´¢ â†’ 
    è‡ªåŠ¨å…¥åº“ â†’ 
    ä¼šè¯ä¿å­˜
  
  // ğŸ” æœç´¢æ‰§è¡Œ
  runLiteratureSearchTasks() â†’
    LiteratureDiscoveryService â†’
    æ‰¹é‡æ–‡çŒ®å‘ç°å’Œæ·»åŠ 
}
```

#### ğŸ¤– **AIé›†æˆ**
- **StreamText API** - å®æ—¶AIå“åº”
- **Zod SchemaéªŒè¯** - ç»“æ„åŒ–è¾“å‡º
- **ThinkTagå¤„ç†** - AIæ€è€ƒè¿‡ç¨‹è§£æ
- **å¤šæ¨¡å‹æ”¯æŒ** - å¯é…ç½®AIæ¨¡å‹

### 5. **æœåŠ¡é›†æˆå±‚ (libs/)**

#### ğŸ”— **å¤–éƒ¨æœåŠ¡**
```typescript
// åç«¯æœåŠ¡
BackendLiteratureService {
  - æ–‡çŒ®è§£ææœåŠ¡
  - PDFå†…å®¹æå–
  - å…ƒæ•°æ®å¢å¼º
}

// Zoteroé›†æˆ
ZoteroService {
  - è®¤è¯ç®¡ç†
  - æ–‡çŒ®åŒæ­¥
  - å¢é‡æ›´æ–°
}

// æ–‡çŒ®è·å–
PdfFetcherService {
  - ArxivProvider
  - UnpaywallProvider
  - DirectUrlProvider
}
```

#### ğŸ“¡ **å®æ—¶é€šä¿¡**
- **SSEé›†æˆ** - Server-Sent Events
- **MCPåè®®** - Model Context Protocol
- **çŠ¶æ€åŒæ­¥** - å‰åç«¯çŠ¶æ€ä¸€è‡´æ€§

---

## ğŸ¯ æ¶æ„ä¼˜åŠ¿åˆ†æ

### âœ… **æŠ€æœ¯ä¼˜åŠ¿**

1. **çŠ¶æ€ç®¡ç†** 
   - Zustandè½»é‡çº§å“åº”å¼
   - å®æ—¶SSEçŠ¶æ€åŒæ­¥
   - å®Œå–„çš„é”™è¯¯æ¢å¤

2. **æ•°æ®æŒä¹…åŒ–**
   - IndexedDBå¤§å®¹é‡å­˜å‚¨
   - Dexie.jsç®€åŒ–API
   - å®Œå–„çš„ç‰ˆæœ¬è¿ç§»

3. **æ™ºèƒ½åŒ–ç¨‹åº¦**
   - AIé©±åŠ¨æ–‡çŒ®å‘ç°
   - æ™ºèƒ½å»é‡åˆå¹¶
   - è‡ªåŠ¨å¼•æ–‡é“¾æ¥

4. **ç”¨æˆ·ä½“éªŒ**
   - å®æ—¶çŠ¶æ€åé¦ˆ
   - æ‰¹é‡æ“ä½œæ”¯æŒ
   - å¤šè§†å›¾æ¨¡å¼

5. **æ‰©å±•æ€§**
   - æ¨¡å—åŒ–è®¾è®¡
   - æ’ä»¶åŒ–æœåŠ¡
   - é¢†åŸŸé©±åŠ¨åˆ†å±‚

### âœ… **ä¸šåŠ¡ä¼˜åŠ¿**

1. **å®Œæ•´å·¥ä½œæµ**
   - æ–‡çŒ®è·å– â†’ è§£æ â†’ å…¥åº“ â†’ å…³è” â†’ åˆ†æ
   - ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–æµç¨‹

2. **å¤šæ•°æ®æº**
   - æ‰‹åŠ¨æ·»åŠ 
   - æœç´¢å‘ç°
   - ZoteroåŒæ­¥
   - æ–‡ä»¶å¯¼å…¥

3. **æ™ºèƒ½å…³è”**
   - ç ”ç©¶ä¼šè¯ç»‘å®š
   - å¼•æ–‡å…³ç³»ç½‘ç»œ
   - ä¸»é¢˜æ ‡ç­¾ç®¡ç†

---

## âš ï¸ æ¶æ„æŒ‘æˆ˜åˆ†æ

### ğŸ”´ **å¤æ‚æ€§æŒ‘æˆ˜**

1. **ä»£ç å¤æ‚åº¦**
   - å•æ–‡ä»¶è¿‡å¤§ (1000+è¡Œ)
   - èŒè´£è¾¹ç•Œæ¨¡ç³Š
   - ä¾èµ–å…³ç³»å¤æ‚

2. **çŠ¶æ€ç®¡ç†å¤æ‚**
   - å¤šå±‚åµŒå¥—çŠ¶æ€
   - å¼‚æ­¥çŠ¶æ€åŒæ­¥
   - é”™è¯¯çŠ¶æ€ä¼ æ’­

3. **ç±»å‹å®šä¹‰åˆ†æ•£**
   - å¤šå¤„ç±»å‹é‡å¤
   - ç¼ºä¹ç»Ÿä¸€å®šä¹‰
   - è¿è¡Œæ—¶éªŒè¯ä¸è¶³

### ğŸ”´ **ç»´æŠ¤æŒ‘æˆ˜**

1. **åŠŸèƒ½è€¦åˆ**
   - UIä¸ä¸šåŠ¡é€»è¾‘è€¦åˆ
   - æœåŠ¡é—´å¾ªç¯ä¾èµ–
   - æµ‹è¯•å›°éš¾

2. **æ€§èƒ½ç“¶é¢ˆ**
   - å¤§åˆ—è¡¨æ¸²æŸ“
   - å®æ—¶çŠ¶æ€æ›´æ–°é¢‘ç¹
   - å†…å­˜å ç”¨è¾ƒé«˜

3. **æ‰©å±•å›°éš¾**
   - æ–°åŠŸèƒ½å½±å“èŒƒå›´å¹¿
   - é…ç½®å¤æ‚
   - è°ƒè¯•å›°éš¾

---

## ğŸš€ é‡æ„æŒ‡å¯¼æ–¹é’ˆ

### ğŸ“‹ **ä¿ç•™çš„æ ¸å¿ƒä»·å€¼**

1. **æ™ºèƒ½åŒ¹é…ç®—æ³•** - MatchingEngineå®Œæ•´ä¿ç•™
2. **å¼•æ–‡ç®¡ç†ç³»ç»Ÿ** - CitationLinkeré‡ç”¨
3. **SSEå®æ—¶æ›´æ–°** - ç”¨æˆ·ä½“éªŒä¼˜åŠ¿
4. **æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ** - Dexie + IndexedDB
5. **AIé›†æˆæ¨¡å¼** - Stream API + ZodéªŒè¯

### ğŸ¯ **é‡æ„ç›®æ ‡**

1. **ç®€åŒ–æ¶æ„**
   - Feature-Firstç»„ç»‡
   - å•ä¸€èŒè´£åŸåˆ™
   - æ¸…æ™°ä¾èµ–å…³ç³»

2. **æå‡æ€§èƒ½**
   - è™šæ‹ŸåŒ–å¤§åˆ—è¡¨
   - çŠ¶æ€ä¼˜åŒ–
   - å†…å­˜ç®¡ç†

3. **å¢å¼ºå¯æµ‹è¯•æ€§**
   - ä¾èµ–æ³¨å…¥
   - çº¯å‡½æ•°è®¾è®¡
   - Mockå‹å¥½

4. **æ”¹å–„å¼€å‘ä½“éªŒ**
   - TypeScriptä¼˜å…ˆ
   - ç»Ÿä¸€é”™è¯¯å¤„ç†
   - å®Œå–„çš„ç±»å‹å®šä¹‰

### ğŸ“ **è¿ç§»ç­–ç•¥**

1. **æ¸è¿›å¼è¿ç§»**
   - ä¿æŒAPIå…¼å®¹
   - åˆ†æ¨¡å—é‡æ„
   - åŠŸèƒ½å¯¹ç­‰éªŒè¯

2. **æ•°æ®è¿ç§»**
   - ä¿æŒæ•°æ®å®Œæ•´æ€§
   - ç‰ˆæœ¬å…¼å®¹å¤„ç†
   - å›æ»šæœºåˆ¶

3. **æµ‹è¯•ä¿éšœ**
   - ç«¯åˆ°ç«¯æµ‹è¯•
   - æ€§èƒ½åŸºå‡†æµ‹è¯•
   - ç”¨æˆ·éªŒæ”¶æµ‹è¯•

---

## ğŸ“Š è¿ç§»å¤æ‚åº¦è¯„ä¼°

### ğŸ”µ **ä½å¤æ‚åº¦** (ç›´æ¥è¿ç§»)
- ç±»å‹å®šä¹‰ (types/)
- å¸¸é‡é…ç½® (constants/)
- å·¥å…·å‡½æ•° (utils/)

### ğŸŸ¡ **ä¸­å¤æ‚åº¦** (é€‚é…è¿ç§»)
- æ•°æ®åº“å±‚ (libs/db/)
- UIç»„ä»¶ (components/Library/)
- åŸºç¡€Hooks (hooks/common/)

### ğŸ”´ **é«˜å¤æ‚åº¦** (é‡æ–°è®¾è®¡)
- çŠ¶æ€ç®¡ç† (libraryStore.ts)
- ä¸šåŠ¡é€»è¾‘Hooks (hooks/useLiteratureResearch.ts)
- æœåŠ¡é›†æˆå±‚ (libs/backend/)

---

## ğŸ¯ ç»“è®ºä¸å»ºè®®

### **æ¶æ„è¯„ä¼°**: â­â­â­â­â˜† (4/5)
- **åŠŸèƒ½å®Œæ•´æ€§**: â­â­â­â­â­ (5/5)
- **æŠ€æœ¯å…ˆè¿›æ€§**: â­â­â­â­â˜† (4/5)  
- **ä»£ç è´¨é‡**: â­â­â­â˜†â˜† (3/5)
- **å¯ç»´æŠ¤æ€§**: â­â­â­â˜†â˜† (3/5)
- **æ‰©å±•æ€§**: â­â­â­â˜†â˜† (3/5)

### **é‡æ„ä»·å€¼**: ğŸ¯ **é«˜ä»·å€¼**
è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½æå…¶ä¸°å¯Œçš„ç³»ç»Ÿï¼Œä½†æ¶æ„å¤æ‚åº¦å·²ç»æ¥è¿‘å¯ç»´æŠ¤æ€§è¾¹ç•Œã€‚Feature-Firsté‡æ„å°†æ˜¾è‘—æå‡ï¼š
- **å¼€å‘æ•ˆç‡** (+40%)
- **ä»£ç è´¨é‡** (+60%)
- **ç»´æŠ¤æˆæœ¬** (-50%)
- **æ‰©å±•èƒ½åŠ›** (+80%)

### **ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: 
1. âœ… **æ¶æ„åˆ†æå®Œæˆ** (å½“å‰)
2. ğŸ”„ **å¼€å§‹æ¸è¿›å¼è¿ç§»** (ç«‹å³)
3. ğŸ¯ **ä¿æŒåŠŸèƒ½å¯¹ç­‰** (å…³é”®)
4. ğŸš€ **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ** (ç›®æ ‡)

---

> ğŸ“… **åˆ†æå®Œæˆæ—¶é—´**: 2025-01-30  
> ğŸ”„ **ä¸‹æ¬¡æ›´æ–°**: é‡æ„å®æ–½å  
> ğŸ‘¥ **åˆ†æå›¢é˜Ÿ**: Architecture Research Team  
> ğŸ“‹ **çŠ¶æ€**: âœ… æ·±åº¦åˆ†æå®Œæˆï¼Œå»ºè®®ç«‹å³å¼€å§‹é‡æ„
